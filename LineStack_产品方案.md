# LineStack  
**Stack dialogue screenshots into a clean vertical story.**

> 冻结版开发规格文档（v1.4）  
> 面向海外市场 · 纯前端本地导出 · 移动端优先

---

## 1. 产品概述

**LineStack** 是一款面向影视爱好者与内容创作者的轻量工具，用于将影视剧对话截图整理、裁切并拼接为适合社交平台传播的纵向长图。

核心能力：
- 区分 **关键帧（Keyframe）** 与 **仅台词（Subtitle-only）**
- 对仅台词图按「保留底部比例」裁切后纵向堆叠
- 一键生成干净、连贯的对话长图
- 全流程 **纯前端、本地处理、不上传图片**

---

## 2. 基本约束（已确认）

- 处理方式：纯前端（浏览器本地）
- 主要使用场景：移动端
- 单次最大图片数量：**30 张（硬限制）**
- 输出宽度：**720 / 1080**
- **默认输出宽度：720**
- 输出格式：**JPG**
- 背景色（仅开启间距时可见）：White `#FFFFFF`（默认）/ Black `#000000` / Dark Gray `#333333`

---

## 3. 图片类型与关键规则

### 3.1 图片类型

- **Keyframe（关键帧）**
  - 保留整张图片（画面 + 台词）
  - 不参与裁切

- **Subtitle-only（仅台词）**
  - **只保留底部一段区域（字幕区）**
  - 参与统一宽度缩放与纵向堆叠

---

### 3.2 第一张关键帧规则（位置锁定 + 回退）

- 当前排序中的 **第 1 张图片**：强制显示为 Keyframe  
- 其它位置图片：可被标记为 Keyframe 或 Subtitle-only（除第 1 张外均可切换）

**当顺序发生变化时：**
- 若用户通过拖拽或 “Move to Top” 导致 **原第 1 张图片不再位于第 1 位**：
  - 该图片的 **关键帧标记将被取消**，并恢复为 Subtitle-only
  - **例外**：若该图片此前被用户手动标记为 Keyframe，则保持不变

---

## 4. 排序与置顶

- 默认按上传顺序排列
- 支持拖拽排序
- 支持“Move to Top”（一次性移动到第 1 位）

---

## 5. Subtitle-only 裁切（全局 Bottom Keep Bar）

- 提供一个滑动条（Bottom Keep Bar）
- 用户通过拖拽控制：**保留底部比例**
- UI 不展示具体百分比数值
- **默认 bottomKeepRatio：0.2**
- 对所有 Subtitle-only 生效
- 不支持单张图片覆盖全局裁切

---

## 6. 输出与拼接规则

- 等比缩放至目标宽度后纵向拼接
- 支持 Keyframe 间距（8px）

---

## 7. Watermark（署名）

- 固定右下角
- 最大长度：**20 字符**
- **超出自动截断**
- 半透明绘制

---

## 8. 导出与分段

- 超过高度阈值自动分段导出
- 文件名自动编号

---

> Spec Version: **v1.4 (Frozen)**
